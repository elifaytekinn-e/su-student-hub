<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-100 p-8">
    <h1 class="text-2xl font-bold mb-6">Yönetici Paneli</h1>
    <button onclick="localStorage.removeItem('isAdmin'); window.location.href='index.html'" class="bg-red-500 text-white px-4 py-2 rounded mb-6">Çıkış</button>
    
    <div class="grid grid-cols-2 gap-8">
        <div class="bg-white p-6 rounded shadow">
            <h2 class="font-bold mb-4">Bekleyen Notlar</h2>
            <div id="notes">Yükleniyor...</div>
        </div>
        <div class="bg-white p-6 rounded shadow">
            <h2 class="font-bold mb-4">Bekleyen Kitaplar</h2>
            <div id="books">Yükleniyor...</div>
        </div>
    </div>

    <script>
        const SUPABASE_URL = "https://kmzbywrcspzwuznexcla.supabase.co";
        const SUPABASE_KEY = "sb_publishable_z2fcMIygDFlXaZD3z1CxbA_YkPXzxNt";
        const asuDb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        if(localStorage.getItem('isAdmin') !== 'true') window.location.href = 'login.html';

        async function load() {
            const { data: n } = await asuDb.from('notes').select('*').eq('is_approved', false);
            document.getElementById('notes').innerHTML = n.length ? n.map(x => `<div class="border-b p-2 flex justify-between"><span>${x.title}</span><button onclick="appr('notes',${x.id})" class="text-green-600 font-bold">Onayla</button></div>`).join('') : 'Bekleyen yok.';

            const { data: b } = await asuDb.from('books').select('*').eq('is_approved', false);
            document.getElementById('books').innerHTML = b.length ? b.map(x => `<div class="border-b p-2 flex justify-between"><span>${x.title}</span><button onclick="appr('books',${x.id})" class="text-green-600 font-bold">Onayla</button></div>`).join('') : 'Bekleyen yok.';
        }

        async function appr(t, id) {
            await asuDb.from(t).update({ is_approved: true }).eq('id', id);
            load();
        }
        load();
    </script>
</body>
</html>
